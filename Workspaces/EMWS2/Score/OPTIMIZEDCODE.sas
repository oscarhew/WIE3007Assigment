*------------------------------------------------------------*;
* EM SCORE CODE;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* TOOL: Extension Class;
* TYPE: SAMPLE;
* NODE: FIMPORT;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* TOOL: Statistics Exploration;
* TYPE: EXPLORE;
* NODE: Stat;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* TOOL: Partition Class;
* TYPE: SAMPLE;
* NODE: Part;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* TOOL: Extension Class;
* TYPE: MODEL;
* NODE: Tree;
*------------------------------------------------------------*;
****************************************************************;
******             DECISION TREE SCORING CODE             ******;
****************************************************************;

******         LENGTHS OF NEW CHARACTER VARIABLES         ******;
LENGTH _WARN_  $    4;

******              LABELS FOR NEW VARIABLES              ******;
label _NODE_ = 'Node' ;
label _LEAF_ = 'Leaf' ;
label P_quality = 'Predicted: quality' ;
label _WARN_ = 'Warnings' ;


******      TEMPORARY VARIABLES FOR FORMATTED VALUES      ******;
LENGTH _ARBFMT_5 $      5; DROP _ARBFMT_5;
_ARBFMT_5 = ' '; /* Initialize to avoid warning. */


******             ASSIGN OBSERVATION TO NODE             ******;

 DROP _BRANCH_;
_BRANCH_ = -1;
  IF  NOT MISSING(alcohol ) AND
  alcohol  <               10.625 THEN DO;
   _BRANCH_ =    1;
  END;
  ELSE IF  NOT MISSING(alcohol ) AND
                10.625 <= alcohol  THEN DO;
   _BRANCH_ =    2;
  END;
IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
    IF             0.992545 <= density  THEN DO;
     _BRANCH_ =    1;
    END;
    ELSE IF density  <             0.992545 THEN DO;
     _BRANCH_ =    2;
    END;
   ELSE _BRANCH_ =    1;
  END;
IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
    IF               0.0385 <= chlorides  THEN DO;
     _BRANCH_ =    1;
    END;
    ELSE IF chlorides  <               0.0385 THEN DO;
     _BRANCH_ =    2;
    END;
   ELSE _BRANCH_ =    1;
  END;
IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
    IF                 6.05 <= fixed_acidity  THEN DO;
     _BRANCH_ =    1;
    END;
    ELSE IF fixed_acidity  <                 6.05 THEN DO;
     _BRANCH_ =    2;
    END;
   ELSE _BRANCH_ =    1;
  END;
IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
    IF                0.375 <= sulphates  THEN DO;
     _BRANCH_ =    1;
    END;
    ELSE IF sulphates  <                0.375 THEN DO;
     _BRANCH_ =    2;
    END;
   ELSE _BRANCH_ =    1;
  END;
IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

IF _BRANCH_ EQ    2 THEN DO;

  _BRANCH_ = -1;
    IF  NOT MISSING(alcohol ) AND
    alcohol  <         11.741666665 THEN DO;
     _BRANCH_ =    1;
    END;
    ELSE IF  NOT MISSING(alcohol ) AND
            11.741666665 <= alcohol  THEN DO;
     _BRANCH_ =    2;
    END;
  IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
      IF             0.990885 <= density  THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF density  <             0.990885 THEN DO;
       _BRANCH_ =    2;
      END;
     ELSE _BRANCH_ =    1;
    END;
  IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
      IF               0.0355 <= chlorides  THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF chlorides  <               0.0355 THEN DO;
       _BRANCH_ =    2;
      END;
     ELSE _BRANCH_ =    1;
    END;
  IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
      IF                 5.45 <= fixed_acidity  THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF fixed_acidity  <                 5.45 THEN DO;
       _BRANCH_ =    2;
      END;
     ELSE _BRANCH_ =    1;
    END;
  IF _BRANCH_ LT 0 AND NOT MISSING(volatile_acidity ) THEN DO;
      IF volatile_acidity  <               0.2975 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF               0.2975 <= volatile_acidity  THEN DO;
       _BRANCH_ =    2;
      END;
     ELSE _BRANCH_ =    2;
    END;
  IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

  IF _BRANCH_ EQ    2 THEN DO;

    _BRANCH_ = -1;
      IF  NOT MISSING(free_sulfur_dioxide ) AND
      free_sulfur_dioxide  <                 21.5 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF  NOT MISSING(free_sulfur_dioxide ) AND
                      21.5 <= free_sulfur_dioxide  THEN DO;
       _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
        IF total_sulfur_dioxide  <                 80.5 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF                 80.5 <= total_sulfur_dioxide  THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
      _ARBFMT_5 = PUT( category , $5.);
       %DMNORMIP( _ARBFMT_5);
        IF _ARBFMT_5 IN ('RED' ) THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
         _BRANCH_ =    2;
        END;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
        IF               0.0505 <= chlorides  THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF chlorides  <               0.0505 THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    1;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
        IF             0.992375 <= density  THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF density  <             0.992375 THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    1;
      END;
    IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

    IF _BRANCH_ EQ    1 THEN DO;

      _BRANCH_ = -1;
        IF  NOT MISSING(sulphates ) AND
        sulphates  <                0.685 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF  NOT MISSING(sulphates ) AND
                       0.685 <= sulphates  THEN DO;
         _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
          IF alcohol  <                13.55 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF                13.55 <= alcohol  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
          IF chlorides  <               0.1235 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF               0.1235 <= chlorides  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
          IF density  <              0.99426 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF              0.99426 <= density  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
          IF fixed_acidity  <                  8.7 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF                  8.7 <= fixed_acidity  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

      IF _BRANCH_ EQ    2 THEN DO;
        _NODE_  =                   29;
        _LEAF_  =                   52;
        P_quality  =     6.70666666666666;
        END;
      ELSE DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(density ) AND
          density  <             0.990315 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(density ) AND
                      0.990315 <= density  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
            IF                13.05 <= alcohol  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF alcohol  <                13.05 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
            IF fixed_acidity  <                 5.55 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                 5.55 <= fixed_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(volatile_acidity ) THEN DO;
            IF volatile_acidity  <                0.205 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                0.205 <= volatile_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF chlorides  <               0.0225 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF               0.0225 <= chlorides  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

        IF _BRANCH_ EQ    1 THEN DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(sulphates ) AND
            sulphates  <                0.335 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(sulphates ) AND
                           0.335 <= sulphates  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
              IF             0.990305 <= density  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF density  <             0.990305 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
              IF                 7.55 <= fixed_acidity  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF fixed_acidity  <                 7.55 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   82;
            _LEAF_  =                   49;
            P_quality  =                7.375;
            END;
          ELSE DO;
            _NODE_  =                   83;
            _LEAF_  =                   50;
            P_quality  =     6.39705882352941;
            END;
          END;
        ELSE DO;
          _NODE_  =                   53;
          _LEAF_  =                   51;
          P_quality  =       5.920245398773;
          END;
        END;
      END;
    ELSE DO;

      _BRANCH_ = -1;
        IF  NOT MISSING(fixed_acidity ) AND
        fixed_acidity  <                 7.85 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF  NOT MISSING(fixed_acidity ) AND
                        7.85 <= fixed_acidity  THEN DO;
         _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
          IF chlorides  <               0.0665 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF               0.0665 <= chlorides  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
          IF density  <              0.99715 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF              0.99715 <= density  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
          IF                   54 <= total_sulfur_dioxide  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF total_sulfur_dioxide  <                   54 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
        _ARBFMT_5 = PUT( category , $5.);
         %DMNORMIP( _ARBFMT_5);
          IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF _ARBFMT_5 IN ('RED' ) THEN DO;
           _BRANCH_ =    2;
          END;
        END;
      IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

      IF _BRANCH_ EQ    2 THEN DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(volatile_acidity ) AND
          volatile_acidity  <                0.395 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(volatile_acidity ) AND
                         0.395 <= volatile_acidity  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF density  <              0.99502 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF              0.99502 <= density  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
            IF sulphates  <                0.765 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                0.765 <= sulphates  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
            IF                   47 <= total_sulfur_dioxide  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF total_sulfur_dioxide  <                   47 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
            IF              21994.5 <= TastingDate  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF TastingDate  <              21994.5 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

        IF _BRANCH_ EQ    2 THEN DO;
          _NODE_  =                   57;
          _LEAF_  =                   58;
          P_quality  =     6.80952380952381;
          END;
        ELSE DO;
          _NODE_  =                   56;
          _LEAF_  =                   57;
          P_quality  =     6.14545454545454;
          END;
        END;
      ELSE DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(sulphates ) AND
          sulphates  <                0.475 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(sulphates ) AND
                         0.475 <= sulphates  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
            IF pH  <                3.325 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                3.325 <= pH  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF density  <              0.99087 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF              0.99087 <= density  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF chlorides  <               0.0435 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF               0.0435 <= chlorides  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
          _ARBFMT_5 = PUT( category , $5.);
           %DMNORMIP( _ARBFMT_5);
            IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF _ARBFMT_5 IN ('RED' ) THEN DO;
             _BRANCH_ =    2;
            END;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

        IF _BRANCH_ EQ    2 THEN DO;
          _NODE_  =                   55;
          _LEAF_  =                   56;
          P_quality  =     6.85526315789473;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(fixed_acidity ) AND
            fixed_acidity  <                 5.35 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(fixed_acidity ) AND
                            5.35 <= fixed_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
              IF TastingDate  <                21917 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                21917 <= TastingDate  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
              IF                 3.43 <= pH  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF pH  <                 3.43 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   84;
            _LEAF_  =                   53;
            P_quality  =                 7.25;
            END;
          ELSE DO;
            IF  NOT MISSING(citric_acid ) AND
              citric_acid  <                0.235 THEN DO;
              _NODE_  =                  100;
              _LEAF_  =                   54;
              P_quality  =     5.95238095238095;
              END;
            ELSE DO;
              _NODE_  =                  101;
              _LEAF_  =                   55;
              P_quality  =     6.59922178988326;
              END;
            END;
          END;
        END;
      END;
    END;
  ELSE DO;

    _BRANCH_ = -1;
      IF  NOT MISSING(volatile_acidity ) AND
      volatile_acidity  <                0.675 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF  NOT MISSING(volatile_acidity ) AND
                     0.675 <= volatile_acidity  THEN DO;
       _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
        IF density  <             1.003175 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF             1.003175 <= density  THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

    IF _BRANCH_ EQ    2 THEN DO;

      _BRANCH_ = -1;
        IF  NOT MISSING(volatile_acidity ) AND
        volatile_acidity  <                1.015 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF  NOT MISSING(volatile_acidity ) AND
                       1.015 <= volatile_acidity  THEN DO;
         _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
          IF                  3.5 <= free_sulfur_dioxide  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF free_sulfur_dioxide  <                  3.5 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
          IF                 5.15 <= fixed_acidity  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF fixed_acidity  <                 5.15 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
          IF pH  <                 3.71 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF                 3.71 <= pH  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

      IF _BRANCH_ EQ    2 THEN DO;
        _NODE_  =                   27;
        _LEAF_  =                   48;
        P_quality  =                    4;
        END;
      ELSE DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(sulphates ) AND
          sulphates  <                0.595 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(sulphates ) AND
                         0.595 <= sulphates  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
            IF alcohol  <                11.15 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                11.15 <= alcohol  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
            IF total_sulfur_dioxide  <                   61 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                   61 <= total_sulfur_dioxide  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF density  <               0.9971 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF               0.9971 <= density  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
            IF fixed_acidity  <                 7.55 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                 7.55 <= fixed_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

        IF _BRANCH_ EQ    2 THEN DO;
          _NODE_  =                   51;
          _LEAF_  =                   47;
          P_quality  =     5.66666666666666;
          END;
        ELSE DO;
          _NODE_  =                   50;
          _LEAF_  =                   46;
          P_quality  =     5.03333333333333;
          END;
        END;
      END;
    ELSE DO;

      _BRANCH_ = -1;
        IF  NOT MISSING(free_sulfur_dioxide ) AND
        free_sulfur_dioxide  <                 11.5 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF  NOT MISSING(free_sulfur_dioxide ) AND
                        11.5 <= free_sulfur_dioxide  THEN DO;
         _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
          IF total_sulfur_dioxide  <                 23.5 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF                 23.5 <= total_sulfur_dioxide  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
          IF                 9.65 <= fixed_acidity  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF fixed_acidity  <                 9.65 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
          IF             0.996955 <= density  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF density  <             0.996955 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
          IF               0.1705 <= chlorides  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF chlorides  <               0.1705 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

      IF _BRANCH_ EQ    1 THEN DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(total_sulfur_dioxide ) AND
          total_sulfur_dioxide  <                   36 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(total_sulfur_dioxide ) AND
                            36 <= total_sulfur_dioxide  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
          _ARBFMT_5 = PUT( category , $5.);
           %DMNORMIP( _ARBFMT_5);
            IF _ARBFMT_5 IN ('RED' ) THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
             _BRANCH_ =    2;
            END;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF               0.0545 <= chlorides  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF chlorides  <               0.0545 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF              0.99391 <= density  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF density  <              0.99391 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
            IF                0.525 <= sulphates  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF sulphates  <                0.525 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

        IF _BRANCH_ EQ    2 THEN DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(alcohol ) AND
            alcohol  <                11.05 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(alcohol ) AND
                           11.05 <= alcohol  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
              IF               0.0485 <= chlorides  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF chlorides  <               0.0485 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
              IF                  7.5 <= free_sulfur_dioxide  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF free_sulfur_dioxide  <                  7.5 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(volatile_acidity ) THEN DO;
              IF                0.295 <= volatile_acidity  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF volatile_acidity  <                0.295 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
              IF                3.235 <= pH  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF pH  <                3.235 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   76;
            _LEAF_  =                   39;
            P_quality  =     5.44117647058823;
            END;
          ELSE DO;
            _NODE_  =                   77;
            _LEAF_  =                   40;
            P_quality  =     4.71428571428571;
            END;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(volatile_acidity ) AND
            volatile_acidity  <                0.365 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(volatile_acidity ) AND
                           0.365 <= volatile_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
              IF              22921.5 <= TastingDate  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF TastingDate  <              22921.5 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
              IF                0.825 <= sulphates  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF sulphates  <                0.825 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
              IF total_sulfur_dioxide  <                 10.5 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                 10.5 <= total_sulfur_dioxide  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
              IF pH  <                3.205 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                3.205 <= pH  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   74;
            _LEAF_  =                   36;
            P_quality  =              6.59375;
            END;
          ELSE DO;

            _BRANCH_ = -1;
              IF  NOT MISSING(free_sulfur_dioxide ) AND
              free_sulfur_dioxide  <                  5.5 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF  NOT MISSING(free_sulfur_dioxide ) AND
                               5.5 <= free_sulfur_dioxide  THEN DO;
               _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
                IF density  <             0.994785 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF             0.994785 <= density  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
                IF total_sulfur_dioxide  <                 11.5 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                 11.5 <= total_sulfur_dioxide  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
                IF chlorides  <                0.057 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                0.057 <= chlorides  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
                IF                0.775 <= sulphates  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF sulphates  <                0.775 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

            IF _BRANCH_ EQ    1 THEN DO;
              _NODE_  =                   96;
              _LEAF_  =                   37;
              P_quality  =     5.40909090909091;
              END;
            ELSE DO;
              _NODE_  =                   97;
              _LEAF_  =                   38;
              P_quality  =                6.125;
              END;
            END;
          END;
        END;
      ELSE DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(pH ) AND
          pH  <                3.245 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(pH ) AND
                         3.245 <= pH  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
            IF                 6.15 <= fixed_acidity  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF fixed_acidity  <                 6.15 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF chlorides  <               0.0595 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF               0.0595 <= chlorides  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
          _ARBFMT_5 = PUT( category , $5.);
           %DMNORMIP( _ARBFMT_5);
            IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF _ARBFMT_5 IN ('RED' ) THEN DO;
             _BRANCH_ =    2;
            END;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(citric_acid ) THEN DO;
            IF                0.215 <= citric_acid  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF citric_acid  <                0.215 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

        IF _BRANCH_ EQ    1 THEN DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(volatile_acidity ) AND
            volatile_acidity  <                0.195 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(volatile_acidity ) AND
                           0.195 <= volatile_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
              IF              23005.5 <= TastingDate  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF TastingDate  <              23005.5 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
              IF chlorides  <                0.016 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                0.016 <= chlorides  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   78;
            _LEAF_  =                   41;
            P_quality  =     6.30827067669173;
            END;
          ELSE DO;

            _BRANCH_ = -1;
              IF  NOT MISSING(sulphates ) AND
              sulphates  <                0.585 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF  NOT MISSING(sulphates ) AND
                             0.585 <= sulphates  THEN DO;
               _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
              _ARBFMT_5 = PUT( category , $5.);
               %DMNORMIP( _ARBFMT_5);
                IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF _ARBFMT_5 IN ('RED' ) THEN DO;
                 _BRANCH_ =    2;
                END;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
                IF                 55.5 <= total_sulfur_dioxide  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF total_sulfur_dioxide  <                 55.5 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
                IF chlorides  <               0.0595 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF               0.0595 <= chlorides  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
                IF fixed_acidity  <                 9.55 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                 9.55 <= fixed_acidity  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

            IF _BRANCH_ EQ    1 THEN DO;
              _NODE_  =                   98;
              _LEAF_  =                   42;
              P_quality  =     5.89415041782729;
              END;
            ELSE DO;
              _NODE_  =                   99;
              _LEAF_  =                   43;
              P_quality  =     6.32051282051282;
              END;
            END;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(chlorides ) AND
            chlorides  <               0.0395 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(chlorides ) AND
                          0.0395 <= chlorides  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
              IF density  <              0.99322 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF              0.99322 <= density  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
              IF sulphates  <                0.515 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                0.515 <= sulphates  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
              IF fixed_acidity  <                 5.85 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                 5.85 <= fixed_acidity  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
            _ARBFMT_5 = PUT( category , $5.);
             %DMNORMIP( _ARBFMT_5);
              IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF _ARBFMT_5 IN ('RED' ) THEN DO;
               _BRANCH_ =    2;
              END;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   80;
            _LEAF_  =                   44;
            P_quality  =     6.53246753246753;
            END;
          ELSE DO;
            _NODE_  =                   81;
            _LEAF_  =                   45;
            P_quality  =      6.1038961038961;
            END;
          END;
        END;
      END;
    END;
  END;
ELSE DO;

  _BRANCH_ = -1;
    IF  NOT MISSING(volatile_acidity ) AND
    volatile_acidity  <               0.2425 THEN DO;
     _BRANCH_ =    1;
    END;
    ELSE IF  NOT MISSING(volatile_acidity ) AND
                  0.2425 <= volatile_acidity  THEN DO;
     _BRANCH_ =    2;
    END;
  IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
      IF pH  <                2.915 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF                2.915 <= pH  THEN DO;
       _BRANCH_ =    2;
      END;
     ELSE _BRANCH_ =    2;
    END;
  IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
      IF density  <             0.992075 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF             0.992075 <= density  THEN DO;
       _BRANCH_ =    2;
      END;
     ELSE _BRANCH_ =    2;
    END;
  IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
      IF chlorides  <               0.0305 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF               0.0305 <= chlorides  THEN DO;
       _BRANCH_ =    2;
      END;
     ELSE _BRANCH_ =    2;
    END;
  IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
      IF sulphates  <                0.375 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF                0.375 <= sulphates  THEN DO;
       _BRANCH_ =    2;
      END;
     ELSE _BRANCH_ =    2;
    END;
  IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

  IF _BRANCH_ EQ    1 THEN DO;

    _BRANCH_ = -1;
      IF  NOT MISSING(volatile_acidity ) AND
      volatile_acidity  <               0.2075 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF  NOT MISSING(volatile_acidity ) AND
                    0.2075 <= volatile_acidity  THEN DO;
       _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
        IF density  <              0.99645 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF              0.99645 <= density  THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
        IF total_sulfur_dioxide  <                168.5 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF                168.5 <= total_sulfur_dioxide  THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
        IF free_sulfur_dioxide  <                 34.5 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF                 34.5 <= free_sulfur_dioxide  THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
        IF                 9.05 <= alcohol  THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF alcohol  <                 9.05 THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    1;
      END;
    IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

    IF _BRANCH_ EQ    2 THEN DO;

      _BRANCH_ = -1;
        IF  NOT MISSING(free_sulfur_dioxide ) AND
        free_sulfur_dioxide  <                 23.5 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF  NOT MISSING(free_sulfur_dioxide ) AND
                        23.5 <= free_sulfur_dioxide  THEN DO;
         _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
          IF total_sulfur_dioxide  <                 96.5 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF                 96.5 <= total_sulfur_dioxide  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
        _ARBFMT_5 = PUT( category , $5.);
         %DMNORMIP( _ARBFMT_5);
          IF _ARBFMT_5 IN ('RED' ) THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
           _BRANCH_ =    2;
          END;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
          IF chlorides  <               0.0285 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF               0.0285 <= chlorides  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
          IF                 9.05 <= fixed_acidity  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF fixed_acidity  <                 9.05 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

      IF _BRANCH_ EQ    1 THEN DO;
        _NODE_  =                   18;
        _LEAF_  =                    9;
        P_quality  =     5.46153846153846;
        END;
      ELSE DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(alcohol ) AND
          alcohol  <         9.5666666665 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(alcohol ) AND
                  9.5666666665 <= alcohol  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF              0.99652 <= density  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF density  <              0.99652 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF               0.0435 <= chlorides  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF chlorides  <               0.0435 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
            IF                150.5 <= total_sulfur_dioxide  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF total_sulfur_dioxide  <                150.5 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
            IF pH  <                3.325 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                3.325 <= pH  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

        IF _BRANCH_ EQ    2 THEN DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(sulphates ) AND
            sulphates  <                0.435 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(sulphates ) AND
                           0.435 <= sulphates  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
              IF                10.55 <= alcohol  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF alcohol  <                10.55 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
              IF pH  <                 2.91 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                 2.91 <= pH  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
              IF chlorides  <               0.0325 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF               0.0325 <= chlorides  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
              IF TastingDate  <              21955.5 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF              21955.5 <= TastingDate  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

          IF _BRANCH_ EQ    2 THEN DO;
            _NODE_  =                   65;
            _LEAF_  =                   17;
            P_quality  =                    6;
            END;
          ELSE DO;
            _NODE_  =                   64;
            _LEAF_  =                   16;
            P_quality  =     5.61538461538461;
            END;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(volatile_acidity ) AND
            volatile_acidity  <               0.2175 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(volatile_acidity ) AND
                          0.2175 <= volatile_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(citric_acid ) THEN DO;
              IF                 0.57 <= citric_acid  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF citric_acid  <                 0.57 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
              IF                0.134 <= chlorides  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF chlorides  <                0.134 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
              IF alcohol  <                  8.3 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                  8.3 <= alcohol  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
              IF density  <             0.992835 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF             0.992835 <= density  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   62;
            _LEAF_  =                   10;
            P_quality  =      5.2258064516129;
            END;
          ELSE DO;

            _BRANCH_ = -1;
              IF  NOT MISSING(volatile_acidity ) AND
              volatile_acidity  <               0.2375 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF  NOT MISSING(volatile_acidity ) AND
                            0.2375 <= volatile_acidity  THEN DO;
               _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
                IF chlorides  <                0.065 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                0.065 <= chlorides  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
                IF                   32 <= free_sulfur_dioxide  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF free_sulfur_dioxide  <                   32 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
                IF              21933.5 <= TastingDate  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF TastingDate  <              21933.5 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
                IF                 8.75 <= alcohol  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF alcohol  <                 8.75 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

            IF _BRANCH_ EQ    2 THEN DO;

              _BRANCH_ = -1;
                IF  NOT MISSING(pH ) AND
                pH  <                 3.08 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF  NOT MISSING(pH ) AND
                                3.08 <= pH  THEN DO;
                 _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
                  IF                 7.25 <= fixed_acidity  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF fixed_acidity  <                 7.25 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
                  IF alcohol  <                 9.15 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                 9.15 <= alcohol  THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
                  IF             0.997815 <= density  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF density  <             0.997815 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
                  IF                22884 <= TastingDate  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF TastingDate  <                22884 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

              IF _BRANCH_ EQ    1 THEN DO;
                _NODE_  =                  104;
                _LEAF_  =                   14;
                P_quality  =     5.66666666666666;
                END;
              ELSE DO;
                _NODE_  =                  105;
                _LEAF_  =                   15;
                P_quality  =                  5.2;
                END;
              END;
            ELSE DO;

              _BRANCH_ = -1;
                IF  NOT MISSING(fixed_acidity ) AND
                fixed_acidity  <                 6.85 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF  NOT MISSING(fixed_acidity ) AND
                                6.85 <= fixed_acidity  THEN DO;
                 _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(citric_acid ) THEN DO;
                  IF citric_acid  <                0.365 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                0.365 <= citric_acid  THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
                  IF sulphates  <                0.545 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                0.545 <= sulphates  THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
                  IF total_sulfur_dioxide  <                  161 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                  161 <= total_sulfur_dioxide
                     THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
                  IF                 3.01 <= pH  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF pH  <                 3.01 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

              IF _BRANCH_ EQ    2 THEN DO;
                _NODE_  =                  103;
                _LEAF_  =                   13;
                P_quality  =     6.14285714285714;
                END;
              ELSE DO;

                _BRANCH_ = -1;
                  IF  NOT MISSING(sulphates ) AND
                  sulphates  <                0.415 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF  NOT MISSING(sulphates ) AND
                                 0.415 <= sulphates  THEN DO;
                   _BRANCH_ =    2;
                  END;
                IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN
                 DO;
                    IF                201.5 <= total_sulfur_dioxide  THEN DO;
                     _BRANCH_ =    1;
                    END;
                    ELSE IF total_sulfur_dioxide
                       <                201.5 THEN DO;
                     _BRANCH_ =    2;
                    END;
                   ELSE _BRANCH_ =    1;
                  END;
                IF _BRANCH_ LT 0 AND NOT MISSING(citric_acid ) THEN DO;
                    IF                 0.47 <= citric_acid  THEN DO;
                     _BRANCH_ =    1;
                    END;
                    ELSE IF citric_acid  <                 0.47 THEN DO;
                     _BRANCH_ =    2;
                    END;
                   ELSE _BRANCH_ =    1;
                  END;
                IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN
                 DO;
                    IF                   55 <= free_sulfur_dioxide  THEN DO;
                     _BRANCH_ =    1;
                    END;
                    ELSE IF free_sulfur_dioxide
                       <                   55 THEN DO;
                     _BRANCH_ =    2;
                    END;
                   ELSE _BRANCH_ =    1;
                  END;
                IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
                    IF                 3.25 <= pH  THEN DO;
                     _BRANCH_ =    1;
                    END;
                    ELSE IF pH  <                 3.25 THEN DO;
                     _BRANCH_ =    2;
                    END;
                   ELSE _BRANCH_ =    1;
                  END;
                IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

                IF _BRANCH_ EQ    1 THEN DO;
                  _NODE_  =                  112;
                  _LEAF_  =                   11;
                  P_quality  =     5.31578947368421;
                  END;
                ELSE DO;
                  _NODE_  =                  113;
                  _LEAF_  =                   12;
                  P_quality  =     5.83333333333333;
                  END;
                END;
              END;
            END;
          END;
        END;
      END;
    ELSE DO;

      _BRANCH_ = -1;
        IF  NOT MISSING(density ) AND
        density  <              0.99791 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF  NOT MISSING(density ) AND
                     0.99791 <= density  THEN DO;
         _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
          IF                 9.15 <= alcohol  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF alcohol  <                 9.15 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
          IF                2.965 <= pH  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF pH  <                2.965 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
          IF fixed_acidity  <                 11.3 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF                 11.3 <= fixed_acidity  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
          IF                  4.5 <= free_sulfur_dioxide  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF free_sulfur_dioxide  <                  4.5 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

      IF _BRANCH_ EQ    2 THEN DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(citric_acid ) AND
          citric_acid  <                0.305 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(citric_acid ) AND
                         0.305 <= citric_acid  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF density  <             0.999205 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF             0.999205 <= density  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
            IF pH  <                3.015 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                3.015 <= pH  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
            IF sulphates  <                0.495 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                0.495 <= sulphates  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF               0.0495 <= chlorides  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF chlorides  <               0.0495 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

        IF _BRANCH_ EQ    2 THEN DO;
          _NODE_  =                   35;
          _LEAF_  =                    8;
          P_quality  =                5.975;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(alcohol ) AND
            alcohol  <                 9.15 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(alcohol ) AND
                            9.15 <= alcohol  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
              IF                0.046 <= chlorides  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF chlorides  <                0.046 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(citric_acid ) THEN DO;
              IF                0.265 <= citric_acid  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF citric_acid  <                0.265 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
              IF density  <              1.00004 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF              1.00004 <= density  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
              IF                  6.7 <= fixed_acidity  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF fixed_acidity  <                  6.7 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

          IF _BRANCH_ EQ    2 THEN DO;
            _NODE_  =                   61;
            _LEAF_  =                    7;
            P_quality  =                    6;
            END;
          ELSE DO;

            _BRANCH_ = -1;
              IF  NOT MISSING(free_sulfur_dioxide ) AND
              free_sulfur_dioxide  <                 44.5 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF  NOT MISSING(free_sulfur_dioxide ) AND
                              44.5 <= free_sulfur_dioxide  THEN DO;
               _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(volatile_acidity ) THEN DO;
                IF volatile_acidity  <                0.185 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                0.185 <= volatile_acidity  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
                IF pH  <                 3.07 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                 3.07 <= pH  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
                IF total_sulfur_dioxide  <                191.5 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                191.5 <= total_sulfur_dioxide  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
                IF density  <               0.9985 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF               0.9985 <= density  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

            IF _BRANCH_ EQ    2 THEN DO;
              _NODE_  =                   89;
              _LEAF_  =                    6;
              P_quality  =     7.63157894736842;
              END;
            ELSE DO;
              _NODE_  =                   88;
              _LEAF_  =                    5;
              P_quality  =     6.96296296296296;
              END;
            END;
          END;
        END;
      ELSE DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(free_sulfur_dioxide ) AND
          free_sulfur_dioxide  <                  7.5 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(free_sulfur_dioxide ) AND
                           7.5 <= free_sulfur_dioxide  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
            IF total_sulfur_dioxide  <                   50 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                   50 <= total_sulfur_dioxide  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
            IF                10.15 <= fixed_acidity  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF fixed_acidity  <                10.15 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF               0.2735 <= chlorides  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF chlorides  <               0.2735 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF density  <             0.990385 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF             0.990385 <= density  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

        IF _BRANCH_ EQ    1 THEN DO;
          _NODE_  =                   32;
          _LEAF_  =                    1;
          P_quality  =     4.81818181818181;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(alcohol ) AND
            alcohol  <         10.116666665 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(alcohol ) AND
                    10.116666665 <= alcohol  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
              IF pH  <                3.445 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                3.445 <= pH  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
              IF              0.99231 <= density  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF density  <              0.99231 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
              IF sulphates  <                0.585 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                0.585 <= sulphates  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(citric_acid ) THEN DO;
              IF citric_acid  <                0.345 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                0.345 <= citric_acid  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

          IF _BRANCH_ EQ    2 THEN DO;
            _NODE_  =                   59;
            _LEAF_  =                    4;
            P_quality  =     6.10828025477707;
            END;
          ELSE DO;

            _BRANCH_ = -1;
              IF  NOT MISSING(free_sulfur_dioxide ) AND
              free_sulfur_dioxide  <                 28.5 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF  NOT MISSING(free_sulfur_dioxide ) AND
                              28.5 <= free_sulfur_dioxide  THEN DO;
               _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
                IF total_sulfur_dioxide  <                109.5 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                109.5 <= total_sulfur_dioxide  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
                IF density  <              0.99308 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF              0.99308 <= density  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
                IF fixed_acidity  <                 5.85 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                 5.85 <= fixed_acidity  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
                IF chlorides  <               0.0395 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF               0.0395 <= chlorides  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

            IF _BRANCH_ EQ    1 THEN DO;
              _NODE_  =                   86;
              _LEAF_  =                    2;
              P_quality  =     5.60576923076923;
              END;
            ELSE DO;
              _NODE_  =                   87;
              _LEAF_  =                    3;
              P_quality  =     5.93209876543209;
              END;
            END;
          END;
        END;
      END;
    END;
  ELSE DO;

    _BRANCH_ = -1;
      IF  NOT MISSING(alcohol ) AND
      alcohol  <                 9.85 THEN DO;
       _BRANCH_ =    1;
      END;
      ELSE IF  NOT MISSING(alcohol ) AND
                      9.85 <= alcohol  THEN DO;
       _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
        IF              0.99318 <= density  THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF density  <              0.99318 THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    1;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
        IF               0.0375 <= chlorides  THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF chlorides  <               0.0375 THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    1;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
        IF                 5.75 <= fixed_acidity  THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF fixed_acidity  <                 5.75 THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    1;
      END;
    IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
        IF free_sulfur_dioxide  <                81.75 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF                81.75 <= free_sulfur_dioxide  THEN DO;
         _BRANCH_ =    2;
        END;
       ELSE _BRANCH_ =    2;
      END;
    IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

    IF _BRANCH_ EQ    2 THEN DO;

      _BRANCH_ = -1;
        IF  NOT MISSING(sulphates ) AND
        sulphates  <                0.545 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF  NOT MISSING(sulphates ) AND
                       0.545 <= sulphates  THEN DO;
         _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
        _ARBFMT_5 = PUT( category , $5.);
         %DMNORMIP( _ARBFMT_5);
          IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF _ARBFMT_5 IN ('RED' ) THEN DO;
           _BRANCH_ =    2;
          END;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
          IF chlorides  <               0.0585 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF               0.0585 <= chlorides  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
          IF                 63.5 <= total_sulfur_dioxide  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF total_sulfur_dioxide  <                 63.5 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
          IF density  <             0.996285 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF             0.996285 <= density  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

      IF _BRANCH_ EQ    1 THEN DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(free_sulfur_dioxide ) AND
          free_sulfur_dioxide  <                 25.5 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(free_sulfur_dioxide ) AND
                          25.5 <= free_sulfur_dioxide  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
            IF total_sulfur_dioxide  <                126.5 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                126.5 <= total_sulfur_dioxide  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(volatile_acidity ) THEN DO;
            IF               0.3475 <= volatile_acidity  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF volatile_acidity  <               0.3475 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF               0.0575 <= chlorides  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF chlorides  <               0.0575 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
          _ARBFMT_5 = PUT( category , $5.);
           %DMNORMIP( _ARBFMT_5);
            IF _ARBFMT_5 IN ('RED' ) THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
             _BRANCH_ =    2;
            END;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

        IF _BRANCH_ EQ    1 THEN DO;
          _NODE_  =                   42;
          _LEAF_  =                   31;
          P_quality  =     5.21176470588235;
          END;
        ELSE DO;
          _NODE_  =                   43;
          _LEAF_  =                   32;
          P_quality  =     5.58823529411764;
          END;
        END;
      ELSE DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(pH ) AND
          pH  <                3.535 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(pH ) AND
                         3.535 <= pH  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
            IF                  4.7 <= fixed_acidity  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF fixed_acidity  <                  4.7 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

        IF _BRANCH_ EQ    2 THEN DO;
          _NODE_  =                   45;
          _LEAF_  =                   35;
          P_quality  =                    5;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(total_sulfur_dioxide ) AND
            total_sulfur_dioxide  <                  186 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(total_sulfur_dioxide ) AND
                             186 <= total_sulfur_dioxide  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
              IF free_sulfur_dioxide  <                74.25 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                74.25 <= free_sulfur_dioxide  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

          IF _BRANCH_ EQ    2 THEN DO;
            _NODE_  =                   73;
            _LEAF_  =                   34;
            P_quality  =     5.24242424242424;
            END;
          ELSE DO;
            _NODE_  =                   72;
            _LEAF_  =                   33;
            P_quality  =     5.78369905956112;
            END;
          END;
        END;
      END;
    ELSE DO;

      _BRANCH_ = -1;
        IF  NOT MISSING(volatile_acidity ) AND
        volatile_acidity  <               0.4225 THEN DO;
         _BRANCH_ =    1;
        END;
        ELSE IF  NOT MISSING(volatile_acidity ) AND
                      0.4225 <= volatile_acidity  THEN DO;
         _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
        _ARBFMT_5 = PUT( category , $5.);
         %DMNORMIP( _ARBFMT_5);
          IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF _ARBFMT_5 IN ('RED' ) THEN DO;
           _BRANCH_ =    2;
          END;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
          IF                110.5 <= total_sulfur_dioxide  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF total_sulfur_dioxide  <                110.5 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
          IF chlorides  <               0.0635 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF               0.0635 <= chlorides  THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    2;
        END;
      IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
          IF                 19.5 <= free_sulfur_dioxide  THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF free_sulfur_dioxide  <                 19.5 THEN DO;
           _BRANCH_ =    2;
          END;
         ELSE _BRANCH_ =    1;
        END;
      IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

      IF _BRANCH_ EQ    2 THEN DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(sulphates ) AND
          sulphates  <                0.535 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(sulphates ) AND
                         0.535 <= sulphates  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(category ) THEN DO;
          _ARBFMT_5 = PUT( category , $5.);
           %DMNORMIP( _ARBFMT_5);
            IF _ARBFMT_5 IN ('WHITE' ) THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF _ARBFMT_5 IN ('RED' ) THEN DO;
             _BRANCH_ =    2;
            END;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
            IF chlorides  <               0.0605 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF               0.0605 <= chlorides  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF density  <             0.995625 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF             0.995625 <= density  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
            IF                151.5 <= total_sulfur_dioxide  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF total_sulfur_dioxide  <                151.5 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

        IF _BRANCH_ EQ    1 THEN DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(citric_acid ) AND
            citric_acid  <                0.035 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(citric_acid ) AND
                           0.035 <= citric_acid  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
              IF free_sulfur_dioxide  <                  3.5 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                  3.5 <= free_sulfur_dioxide  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
              IF density  <              0.99252 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF              0.99252 <= density  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
              IF                 3.53 <= pH  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF pH  <                 3.53 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
              IF total_sulfur_dioxide  <                  8.5 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                  8.5 <= total_sulfur_dioxide  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   68;
            _LEAF_  =                   27;
            P_quality  =     4.64516129032258;
            END;
          ELSE DO;
            _NODE_  =                   69;
            _LEAF_  =                   28;
            P_quality  =     5.01744186046511;
            END;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(total_sulfur_dioxide ) AND
            total_sulfur_dioxide  <                 46.5 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(total_sulfur_dioxide ) AND
                            46.5 <= total_sulfur_dioxide  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
              IF free_sulfur_dioxide  <                 14.5 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                 14.5 <= free_sulfur_dioxide  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(citric_acid ) THEN DO;
              IF citric_acid  <                0.095 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                0.095 <= citric_acid  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
              IF                3.355 <= pH  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF pH  <                3.355 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
              IF chlorides  <               0.0725 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF               0.0725 <= chlorides  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;
            _NODE_  =                   70;
            _LEAF_  =                   29;
            P_quality  =     5.38235294117647;
            END;
          ELSE DO;
            _NODE_  =                   71;
            _LEAF_  =                   30;
            P_quality  =     5.11290322580645;
            END;
          END;
        END;
      ELSE DO;

        _BRANCH_ = -1;
          IF  NOT MISSING(citric_acid ) AND
          citric_acid  <                0.265 THEN DO;
           _BRANCH_ =    1;
          END;
          ELSE IF  NOT MISSING(citric_acid ) AND
                         0.265 <= citric_acid  THEN DO;
           _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
            IF sulphates  <                0.365 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                0.365 <= sulphates  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
            IF fixed_acidity  <                 5.95 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF                 5.95 <= fixed_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
            IF density  <              0.99431 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF              0.99431 <= density  THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    2;
          END;
        IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
            IF              23003.5 <= TastingDate  THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF TastingDate  <              23003.5 THEN DO;
             _BRANCH_ =    2;
            END;
           ELSE _BRANCH_ =    1;
          END;
        IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

        IF _BRANCH_ EQ    1 THEN DO;
          _NODE_  =                   38;
          _LEAF_  =                   18;
          P_quality  =     5.14695340501792;
          END;
        ELSE DO;

          _BRANCH_ = -1;
            IF  NOT MISSING(volatile_acidity ) AND
            volatile_acidity  <                0.275 THEN DO;
             _BRANCH_ =    1;
            END;
            ELSE IF  NOT MISSING(volatile_acidity ) AND
                           0.275 <= volatile_acidity  THEN DO;
             _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
              IF fixed_acidity  <                 5.75 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF                 5.75 <= fixed_acidity  THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    2;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
              IF                  250 <= total_sulfur_dioxide  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF total_sulfur_dioxide  <                  250 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
              IF                23002 <= TastingDate  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF TastingDate  <                23002 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
              IF                3.485 <= pH  THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF pH  <                3.485 THEN DO;
               _BRANCH_ =    2;
              END;
             ELSE _BRANCH_ =    1;
            END;
          IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

          IF _BRANCH_ EQ    1 THEN DO;

            _BRANCH_ = -1;
              IF  NOT MISSING(density ) AND
              density  <             0.998395 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF  NOT MISSING(density ) AND
                          0.998395 <= density  THEN DO;
               _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
                IF pH  <                3.435 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                3.435 <= pH  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
                IF fixed_acidity  <                 11.1 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                 11.1 <= fixed_acidity  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
                IF sulphates  <                0.725 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF                0.725 <= sulphates  THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
                IF                   22 <= total_sulfur_dioxide  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF total_sulfur_dioxide  <                   22 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

            IF _BRANCH_ EQ    2 THEN DO;

              _BRANCH_ = -1;
                IF  NOT MISSING(density ) AND
                density  <               0.9988 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF  NOT MISSING(density ) AND
                              0.9988 <= density  THEN DO;
                 _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
                  IF free_sulfur_dioxide  <                38.25 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                38.25 <= free_sulfur_dioxide
                     THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(chlorides ) THEN DO;
                  IF               0.0495 <= chlorides  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF chlorides  <               0.0495 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
                  IF pH  <                 3.14 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                 3.14 <= pH  THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
                  IF sulphates  <                 0.39 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                 0.39 <= sulphates  THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

              IF _BRANCH_ EQ    1 THEN DO;
                _NODE_  =                  108;
                _LEAF_  =                   21;
                P_quality  =     6.64705882352941;
                END;
              ELSE DO;
                _NODE_  =                  109;
                _LEAF_  =                   22;
                P_quality  =     5.57142857142857;
                END;
              END;
            ELSE DO;

              _BRANCH_ = -1;
                IF  NOT MISSING(citric_acid ) AND
                citric_acid  <                0.425 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF  NOT MISSING(citric_acid ) AND
                               0.425 <= citric_acid  THEN DO;
                 _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
                  IF                0.475 <= sulphates  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF sulphates  <                0.475 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
                  IF                 8.95 <= alcohol  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF alcohol  <                 8.95 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(fixed_acidity ) THEN DO;
                  IF                 6.55 <= fixed_acidity  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF fixed_acidity  <                 6.55 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
                  IF              0.99319 <= density  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF density  <              0.99319 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

              IF _BRANCH_ EQ    2 THEN DO;
                _NODE_  =                  107;
                _LEAF_  =                   20;
                P_quality  =     5.26984126984127;
                END;
              ELSE DO;
                _NODE_  =                  106;
                _LEAF_  =                   19;
                P_quality  =     5.66666666666666;
                END;
              END;
            END;
          ELSE DO;

            _BRANCH_ = -1;
              IF  NOT MISSING(fixed_acidity ) AND
              fixed_acidity  <                10.45 THEN DO;
               _BRANCH_ =    1;
              END;
              ELSE IF  NOT MISSING(fixed_acidity ) AND
                             10.45 <= fixed_acidity  THEN DO;
               _BRANCH_ =    2;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(total_sulfur_dioxide ) THEN DO;
                IF                   25 <= total_sulfur_dioxide  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF total_sulfur_dioxide  <                   25 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(alcohol ) THEN DO;
                IF                 8.45 <= alcohol  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF alcohol  <                 8.45 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 AND NOT MISSING(pH ) THEN DO;
                IF                2.885 <= pH  THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF pH  <                2.885 THEN DO;
                 _BRANCH_ =    2;
                END;
               ELSE _BRANCH_ =    1;
              END;
            IF _BRANCH_ LT 0 THEN _BRANCH_ =    1;

            IF _BRANCH_ EQ    2 THEN DO;
              _NODE_  =                   95;
              _LEAF_  =                   26;
              P_quality  =      5.9047619047619;
              END;
            ELSE DO;

              _BRANCH_ = -1;
                IF  NOT MISSING(citric_acid ) AND
                citric_acid  <                0.295 THEN DO;
                 _BRANCH_ =    1;
                END;
                ELSE IF  NOT MISSING(citric_acid ) AND
                               0.295 <= citric_acid  THEN DO;
                 _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
                  IF              1.00613 <= density  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF density  <              1.00613 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(TastingDate ) THEN DO;
                  IF                23005 <= TastingDate  THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF TastingDate  <                23005 THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    1;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(free_sulfur_dioxide ) THEN DO;
                  IF free_sulfur_dioxide  <                    2 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                    2 <= free_sulfur_dioxide
                     THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 AND NOT MISSING(sulphates ) THEN DO;
                  IF sulphates  <                 0.32 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF                 0.32 <= sulphates  THEN DO;
                   _BRANCH_ =    2;
                  END;
                 ELSE _BRANCH_ =    2;
                END;
              IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

              IF _BRANCH_ EQ    1 THEN DO;
                _NODE_  =                  110;
                _LEAF_  =                   23;
                P_quality  =     5.69565217391304;
                END;
              ELSE DO;

                _BRANCH_ = -1;
                  IF  NOT MISSING(chlorides ) AND
                  chlorides  <                0.033 THEN DO;
                   _BRANCH_ =    1;
                  END;
                  ELSE IF  NOT MISSING(chlorides ) AND
                                 0.033 <= chlorides  THEN DO;
                   _BRANCH_ =    2;
                  END;
                IF _BRANCH_ LT 0 AND NOT MISSING(density ) THEN DO;
                    IF density  <               0.9921 THEN DO;
                     _BRANCH_ =    1;
                    END;
                    ELSE IF               0.9921 <= density  THEN DO;
                     _BRANCH_ =    2;
                    END;
                   ELSE _BRANCH_ =    2;
                  END;
                IF _BRANCH_ LT 0 THEN _BRANCH_ =    2;

                IF _BRANCH_ EQ    1 THEN DO;
                  _NODE_  =                  114;
                  _LEAF_  =                   24;
                  P_quality  =                    6;
                  END;
                ELSE DO;
                  _NODE_  =                  115;
                  _LEAF_  =                   25;
                  P_quality  =     5.26300578034682;
                  END;
                END;
              END;
            END;
          END;
        END;
      END;
    END;
  END;

****************************************************************;
******          END OF DECISION TREE SCORING CODE         ******;
****************************************************************;

drop _LEAF_;
*------------------------------------------------------------*;
* TOOL: Model Compare Class;
* TYPE: ASSESS;
* NODE: MdlComp;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* TOOL: Score Node;
* TYPE: ASSESS;
* NODE: Score;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* Score: Creating Fixed Names;
*------------------------------------------------------------*;
LABEL EM_SEGMENT = 'Node';
EM_SEGMENT = _NODE_;
LABEL EM_PREDICTION= "Prediction for quality";
EM_PREDICTION = P_quality;
